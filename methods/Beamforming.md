## Beamforming

### Intro
- Estimates the amount of activity at any given location 
- Subject to unit-gain constraint
	- If the source had signal of amplitude 1 and was projected to the sensors, the reconstruction should dhow a signal of amplitude 1 at that location
- Assume that sources in different parts of the brain have no temporal correlation
- The brain is divided into a 3D grid and the source strength for each point is computed
- Estimates are calculated in the time domain
- The result is a 3D distribution of the amplitude or power of sources
- This distribution is overlaid on a structural image

### Method
- The data is preprocessed and the covariance matrix is calculated for data and noise
	
	- nchan * nchan 
	- $(channels * channels'/(nsamples-1))$ 
	
- A forward model is constructed by making an individual head model based on anatomy
	- Find brain surface and segment
	- Prepare head model
	
- Source model is prepared for each subject

- All the information is combined into the leadfield (sensors x points x dimensions) 

- A spatial filter is created using the LCMV beamformer

  - The spatial filter is needed since we do not know the orientation of the dipoles
  - The filter passes only the signal that was generated by the dipole at the specified location

  ### Procedure

  - EEG signal = $V \in R^{m \times n}$ (m electrodes and n time samples)
  - Output of the beamformer is $y \in R^{1 \times n}$ and $y = w^T V$
  - The vector $w \in R^{m \times 1}$ is the weight vector of the beamformer that linearly combines the signals at electrodes
  - We want to extract the signal from an area modeled by a dipole at location $r_d$ with dipole components d
    - Potential distribution $c = L(r_d)*d$ with $c \in R^{m \times 1}$
    - **Beamformer requirement: unit gain constraint**
      - any contribution must be preserved with unity gain
    - Therefore, $w^Tc = 1$
  - Output power of the beamformer equals $w^T*R_v*w$, where $R_v$ is the covariance matrix of the channels

### LCMV 

- The linearly constrained minimum variance beamformer minimizes the output power 

- $\min_{w} w^T*R_v*w \mid w^Tc=1 $ (such that)

- This beamformer minimizes the overall output power to suppress contributions from undesired regions

- The data in the covariance matrix is used to determine the weights in $w$

  