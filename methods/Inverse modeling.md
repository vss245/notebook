## Inverse modeling

### Principle

- EEG/MEG signal is generated by dipoles, where the dipole moment represents neural activity
- Dipole parameters consist of the magnitude and orientation
  - For each position $r_d$ in the head, the relation between d and V (measured potentials at m electrodes) is $V = L(r_d) * d$
  - L is the lead field matrix based on the head model

- Most common frequency range: 0,1-100 Hz

- Computation of potentials and induced fields requires a head model

- - Head models can be individual and based on scans, or simplified geometries with nested concentric shells for the brain, skull and scalp

- Localizing the EEG source - solving the forward and the inverse problem

- Estimated from: 

- - EEG/MEG activity
  - Channel positions
  - Head model
  - Source model

- ### Components 

- - Forward modeling - estimating the potential or fiel distribution for a known source and a known head model

  - - Source model discretizes the brain volume into a grid
    - A lead field matrix can be computed for each grid point 

- Forward problem - determining the potential at each scalp electrode generated by a known source in the brain 

- - Recommended to use individual information from the MRI to determine skull thickness, since it's variable

  - Lead field - determines how the electric activity at a certain electrode is related to activity of the sources within the brain (forward model)

  - Information from the source model is used to estimate the solution of the inverse problem

  - Methods:

  - - Boundary element modelling (elements: scalp, skull, brain)

    - - Approximates the compartments by simple surfaces
      - Nested volumes

    - Finite element modeling (scalp, skull, CSF, grey matter and white matter)

- Inverse problem:

- Estimating the unknown sources corresponding to the measured EEG or MEG

- - Determining the intracranial sources that generate a given potential measurement at the scalp
  - Problem: a large number of different source distributions can produce the same potential field on the scalp
  - A priori assumptions are needed

### Approaches:

#### Equivalent dipoles (dipole source localization)

- - Few active areas in the brain generate the scalp potential field
  - Non-linear multidimensional optimization procedures determine the parameters that best explain observed data
  - Maximum number of dipoles depends on the # of scalp electrodes and is limited by non-linearity of the algorithm
  - Sources in the brain are estimated from the measured electric or magnetic potential fields using head models
  - If the amount and extent of tissue excitation is small compared to the distance of the tissue from the sensors, then the approximation is valid and the region can be approximated with an equivalent dipole
  - BESA, MUSIC

- New methods do not make assumptions about the number of dipoles 

  #### Minimum norm estimate

- - Minimum norm solution
  - Current distribution has minimum energy (least square error)
  - Forward solution of this distribution should optimally explain the data
  - MNS is biased towards sources closer to the sensors
  - Approaches have been introduced to mitigate the bias: weighted MN

- #### LORETA

- - - minimizing the norm of the 2nd order spatial derivative of the current source distribution

- - Obtains a true 3D solution by sacrificing spatial resolution

  - No point dipoles, distributed activity throughout the brain is computed, discretized as a 3d grid

  - Assumptions to obtain a meaningful solution from the infinite set of possible solutions:

  - - Neighboring neurons are most likely to be active synchronously and simultaneously
    - => neighboring grid points are more likely to be synchronized
    - => find the smoothest of all possible solutions

  - Result is a low resolution tomography image (low res due to the smoothness constraint)

- Beamformer

  - Estimates the amount of activity at any given location 
  - Subject to unit-gain constraint
    - If the source had signal of amplitude 1 and was projected to the sensors, the reconstruction should dhow a signal of amplitude 1 at that location
  - Also minimizes output power (spatial filter to suppress contibutions from other sources)
  - Assume that sources in different parts of the brain have no temporal correlation

### Steps 

- Standard preprocessing (filtering, downsampling, epoching, artefact rejection - ICA, spatial filters, manual)

- Constructing the head model

- - Usually, model is based on the subject MRI data
  - Templates also exist
  - MRI needs to be segmented in order to delineate different compartments with different conductivity parameters
  - Solution points need to be determined in the grey matter

- Electrode positions need to be determined and coregistered to the MRI head

- Lead field calculation

- - A head model is creased based on the BEM or the FEM method

  - - Better than the 3 spherical shell models
    - Computationally intensive

  - Skull resistivity increases with age (around 1:30 between the brain and the skull, ranging from 10 at a young age to 25 at 50)

- Calculating the inverse solution

- - There is no unique solution => a priori assumptions are needed

  - Regularization is often used to smooth the results

  - - Too much smoothing degrades the accuracy

